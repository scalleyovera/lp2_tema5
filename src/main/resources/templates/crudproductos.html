<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Mantenimiento de Productos</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
</head>

<body>

	<div class="container">
		<div class="row">
			<div class="col-6 col-sm-4">
				<h1>Mantenimiento de Productos</h1>

				<form th:action="@{/productos/grabar}" th:object="${producto}" method="post">

					<div class="form-group">
						<label for="inputCod">Código</label>
						<input type="text" class="form-control" id="inputCod" name="idProd"
							th:value="*{idProd}" placeholder="Código" readonly>
					</div>

					<div class="form-group">
						<label for="inputNom">Nombre</label>
						<input type="text" class="form-control" id="inputNom" name="desProd"
							th:value="*{desProd}" placeholder="Nombre">
					</div>

					<div class="form-row">
						<div class="form-group col-md-6">
							<label for="inputStk">Stock</label>
							<input type="number" class="form-control" id="inputStk" name="stkProd"
								th:value="*{stkProd}" placeholder="0">
						</div>

						<div class="form-group col-md-6">
							<label for="inputPrec">Precio</label>
							<input type="number" step="0.01" class="form-control" id="inputPrec" name="preProd"
								th:value="*{preProd}" placeholder="0.00">
						</div>
					</div>

					<div class="form-row">
						<div class="form-group col-md-4">
							<label for="inputCat">Categoría</label>
							<select id="inputCat" class="form-control" name="categoria.idcategoria"
								th:value="${producto.categoria != null ? producto.categoria.idcategoria : 0}">
								<option value="0">Seleccione...</option>
								<option th:each="c : ${lstCategorias}"
										th:value="${c.idcategoria}"
										th:text="${c.descripcion}"
										th:selected="${producto.categoria != null and producto.categoria.idcategoria == c.idcategoria}">
								</option>
							</select>
						</div>

						<div class="form-group col-md-4">
							<label for="inputEstado">Estado</label>
							<select id="inputEstado" class="form-control" name="estProd"
								th:value="*{estProd}">
								<option value="1" th:selected="*{estProd == 1}">Activo</option>
								<option value="0" th:selected="*{estProd == 0}">Eliminado</option>
							</select>
						</div>

						<div class="form-group col-md-4">
							<label for="inputProv">Proveedor</label>
							<select id="inputProv" class="form-control" name="proveedor.idproveedor"
								th:value="${producto.proveedor != null ? producto.proveedor.idproveedor : 0}">
								<option value="0">Seleccione...</option>
								<option th:each="p : ${lstProveedor}"
										th:value="${p.idproveedor}"
										th:text="${p.nombre_rs}"
										th:selected="${producto.proveedor != null and producto.proveedor.idproveedor == p.idproveedor}">
								</option>
							</select>
						</div>
					</div>

					<button type="submit" class="btn btn-primary">Registrar</button>
					<a th:href="@{/productos/listar}" class="btn btn-success">Listar</a>
				</form>

				<div th:text="${mensaje}" th:classappend="${cssmensaje}"></div>
			</div>

			<div class="col-6 col-sm-7">
				<h3></h3>
				<table class="table table-striped table-hover mt-3">
					<thead class="thead-dark">
						<tr>
							<th>Imagen</th>
							<th>ID</th>
							<th>Descripción</th>
							<th>Stock</th>
							<th>Precio</th>
							<th>Estado</th>
							<th>Categoría</th>
							<th>Proveedor</th>
							<th>Acciones</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="p : ${lstProductos}">
							<td>
								<img th:src="@{'/img/productos/' + ${p.idProd} + '.png'}"
								     width="80" height="80" alt="Imagen del producto"
									 onerror="this.src='/img/productos/noImagen.png'">
							</td>
							<td th:text="${p.idProd}"></td>
							<td th:text="${p.desProd}"></td>
							<td th:text="${p.stkProd}"></td>
							<td th:text="'S/ ' + ${#numbers.formatDecimal(p.preProd, 1, 'COMMA', 2, 'POINT')}"></td>
							<td th:text="${p.estProd == 1 ? 'Activo' : 'Eliminado'}"></td>
							<td th:text="${p.categoria.descripcion}"></td>
							<td th:text="${p.proveedor.nombre_rs}"></td>
							<td>
								<a th:href="@{'/productos/editar/' + ${p.idProd}}" class="btn btn-warning btn-sm">Editar</a>
								<a th:href="@{'/productos/eliminar/' + ${p.idProd}}" class="btn btn-danger btn-sm"
								   onclick="return confirm('¿Seguro que deseas eliminar este producto?');">
									Eliminar
								</a>
							</td>
						</tr>

					</tbody>
				</table>
			</div>
		</div>
	</div>
</body>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>

</html>
